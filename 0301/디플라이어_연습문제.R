emp = read.csv('emp.csv')
# install.packages('dplyr')
# 문제1. 직원 이름(ENAME), 직업(JOB), 그리고 부서 번호(DEPTNO) 컬럼(열)만 선택하세요.
emp_result = emp %>% select(ENAME,JOB,DEPTNO)
print(emp_result)

# 문제2. 급여(SAL)가 2000 이상인 직원만 필터링하세요.
sal2000 = emp %>% filter(SAL >= 2000)
print(sal2000)

# 문제3. 급여(SAL)를 기준으로 내림차순으로 정렬하세요.
sal_desc = emp %>% arrange(desc(SAL))
print(sal_desc)

# 문제4. 부서 번호(DEPTNO)가 30인 직원 중, 이름(ENAME)과 급여(SAL)만 선택하고 급여 순으로 내림차순 정렬하세요.
name_sal30 = emp %>% filter(DEPTNO == 30) %>% select(ENAME,SAL) %>% arrange(desc(SAL))
print(name_sal30)

# 문제5. 직업(JOB)이 "MANAGER"인 직원 중, 부서 번호(DEPTNO)와 급여(SAL)를 선택하고 급여 순으로 오름차순 정렬하세요.
man_dept_sal = emp %>% filter(JOB == 'MANAGER') %>% select(DEPTNO, SAL) %>% arrange(SAL)
print(man_dept_sal)

# 문제6. 급여(SAL)가 1500 이상이고 부서 번호(DEPTNO)가 20인 직원의 이름(ENAME), 직업(JOB), 그리고 급여(SAL)를 선택한 뒤 이름 순으로 정렬(오름차순)하세요.
sal1500_20 = emp %>% filter(SAL >= 1500 & DEPTNO == 20 ) %>% select(ENAME, JOB, SAL) %>% arrange(ENAME)
print(sal1500_20)


# 문제7.  직업(JOB)이 "SALESMAN"인 직원 중, 급여(SAL)가 1500 이상인 직원의 이름(ENAME), 급여(SAL), 부서 번호(DEPTNO)를 선택하고 급여 순으로 내림차순 정렬하세요.
sale_1500 = emp %>% filter(JOB == 'SALESMAN'& SAL >= 1500) %>% select(ENAME,SAL,DEPTNO) %>% arrange(desc(SAL))
print(sale_1500)

# 문제 8. 부서 번호(DEPTNO)가 10 또는 30인 직원 중, 이름(ENAME), 직업(JOB), 급여(SAL)을 선택하고 이름 순으로 정렬하세요.
dept_1030 = emp %>% filter(DEPTNO == 10 | DEPTNO == 30) %>% select(ENAME, JOB, SAL) %>% arrange(ENAME)
print(dept_1030)

# 문제 9. mutate()를 사용하여 급여(SAL)에 보너스(COMM, NA는 0으로 간주)를 더한 총 급여(Total_Salary) 열을 추가하세요.
total_emp = emp %>% mutate(Total_Salary = SAL + ifelse(is.na(COMM),0,COMM))
View(total_emp)

